<html xmlns="http://www.w3.org/1999/xhtml">
<head>

	<meta http-equiv="content-type" content="text/html; charset=iso-8859-1"/>
	<title>jQuery treeView</title>
	
	<script type="text/javascript" src="/js/jquery-latest.pack.js"></script>
	<script type="text/javascript" src="/js/jquery.treeview.pack.js"></script>
	<script type="text/javascript" src="/js/interface.js"></script>
	<script type="text/javascript">
	function designTree() {
		$("#tree").Treeview({ 
			control: "#treecontrol" ,
			speed: 'fast',
			collapsed:false
		});
	}
	
	$(document).ready(function(){
		designTree() ;
		
		$("span.SectionItem").Draggable({
			revert:		true,
			ghosting:	true,
			opacity:	0.8,
		});
		
		$("span.SectionItem, span.AreaItem").Droppable({
			accept:		'SectionItem',
			hoverclass: 'dropOver',
			ondrop:		function(dropped) {
				if(this == dropped) return;
				
				// Sposta
				subbranch = $('ul', this.parentNode);
				
				if (subbranch.size() == 0) {
					$(this).after('<ul></ul>');
					subbranch = $('ul', this.parentNode);
				}
				
				subbranch.eq(0).append(dropped.parentNode);
				
				// Resetta l'albero
				$('div', "#tree").remove();
				$('span', "#tree").removeAttr('style');
				$('ul', "#tree").removeAttr('style');

				$("li[@class='expandable lastExpandable'], li[@class='expandable']", "#tree").attr('class', 'closed');
				$("li[@class='collapsable lastCollapsable'], li[@class='last'], , li[@class='closed last']", "#tree").removeAttr('class');
				
				$('li/ul', "#tree").each(function(i){
					if(!($('li', this).size())) {
						$(this).remove() ;
					}
				});
				
				designTree() ;
				
//document.getElementById("test").innerHTML = $("#tree").html() ;
			}
		}) ;
		
	});
	
	</script>
	<style type="text/css">
		html, body {height:100%; margin: 0; padding: 0; }

		body {
			font-family: Verdana, helvetica, arial, sans-serif;
			font-size: 11px;
			background: #fff;
			color: #333;
			padding-left: 20px;
		} /* Reset Font Size */
		
		.treeview, .treeview ul { 
			padding: 0;
			margin: 0px;
			list-style: none;
		}	

		.treeview li { 
			margin: 0;
			padding: 3px 0pt 3px 16px;
		}
		
		.treeview li { background: url(img/treeview/tv-item.gif) 0 0 no-repeat; }
	  	.treeview .collapsable { background-image: url(img/treeview/tv-collapsable.gif); }
	  	.treeview .expandable { background-image: url(img/treeview/tv-expandable.gif); }
	  	.treeview .last { background-image: url(img/treeview/tv-item-last.gif); }
	  	.treeview .lastCollapsable { background-image: url(img/treeview/tv-collapsable-last.gif); }
	  	.treeview .lastExpandable { background-image: url(img/treeview/tv-expandable-last.gif); }

	  	#tree.treeview li { background: url(img/treeview/area/tv-item.gif) 0 0 no-repeat; }
	  	#tree.treeview .collapsable { background-image: url(img/treeview/area/tv-collapsable.gif); }
	  	#tree.treeview .expandable { background-image: url(img/treeview/area/tv-expandable.gif); }
	  	#tree.treeview .last { background-image: url(img/treeview/area/tv-item-last.gif); }
	  	#tree.treeview .lastCollapsable { background-image: url(img/treeview/area/tv-collapsable-last.gif); }
	  	#tree.treeview .lastExpandable { background-image: url(img/treeview/area/tv-expandable-last.gif); }
		
	  	#treecontrol { margin: 1em 0; }

		span.dropOver
		{
			background-color: #00c;
			color: #fff;
		}	  	
		</style>
	</head>
	<body>

	
	<h4>Test Areee /Sezioni</h4>
	<div id="treecontrol">
		<a href="#">Collapse All</a>
		<a href="#">Expand All</a>
		<a href="#">Toggle All</a>
	</div>
	
	<div>
	
	<ul id="tree">
		<li><span class="AreaItem">Area 1</span></li>
		<li>
			<span class="AreaItem">Area 2</span>
			<ul>
				<li>
					<span class="SectionItem">Sezione 2.1</span>
					<ul>
						<li><span class="SectionItem">Sezione 2.1.1</span></li>
						<li><span class="SectionItem">Sezione 2.1.2</span></li>
					</ul>
				</li>
				<li><span class="SectionItem">Sezione 2.2</span></li>
				<li>
					<span class="SectionItem">Sezione 2.3</span>
					<ul>
						<li><span class="SectionItem">Sezione 2.3.1</span></li>
						<li><span class="SectionItem">Sezione 2.3.2</span></li>
					</ul>
				</li>
			</ul>
		</li>
	</ul>
	

	</div>

<!-- textarea id="test" cols="150" rows="40"></textarea -->
</body></html>